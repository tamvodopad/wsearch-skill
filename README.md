# WSearch — Поиск участников ВОВ

Скилл для [Claude Code](https://claude.com/claude-code) для систематического сбора данных об участниках Великой Отечественной войны с сайта [warsearch.ru](https://warsearch.ru) с экспортом в Excel.

## Зачем это нужно

При генеалогическом исследовании часто возникает задача: найти всех участников ВОВ из конкретной деревни или села. Ручной поиск на сайтах баз данных — монотонная работа:

- Много вариантов написания одного населённого пункта
- Нужно проверять связь каждой записи с локацией
- Данные разбросаны по разным полям (рождение, призыв, жительство)
- Результаты нужно систематизировать

Этот скилл автоматизирует процесс и создаёт структурированный Excel-файл.

## Возможности

- **Интерактивный сбор параметров** — 5 вопросов для точной настройки поиска
- **Множественные варианты написания** — учёт старых названий, ошибок, транслитерации
- **Трёхуровневая верификация** — подтверждение связи с локацией (A/B/C)
- **Структурированный экспорт** — Excel с 4 листами для разных целей
- **Журнал поиска** — воспроизводимость исследования

## Установка

### Локально (для разработки)

```bash
git clone https://github.com/tamvodopad/wsearch-skill.git
cd wsearch-skill
```

### Глобально (для использования)

```bash
ln -s /path/to/wsearch ~/.claude/skills/wsearch
```

### Зависимости

```bash
pip3 install openpyxl
```

## Использование

В Claude Code:

```
/wsearch
```

Или просто попросите:

> Найди всех участников ВОВ из деревни Вишур Кизнерского района

## Алгоритм работы

```
┌─────────────────────────────────────────────────────────┐
│  1. СБОР ПАРАМЕТРОВ                                     │
│     ├─ Населённый пункт                                 │
│     ├─ Район/область                                    │
│     ├─ Варианты написания                               │
│     ├─ Критерии включения                               │
│     └─ Целевая популяция                                │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│  2. ПОДГОТОВКА ВАРИАНТОВ                                │
│     ├─ Основное название                                │
│     ├─ Комбинации с районом                             │
│     └─ Альтернативные написания                         │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│  3. ПОИСК                                               │
│     Для каждого варианта:                               │
│     ├─ Выполнить запрос                                 │
│     ├─ Дождаться загрузки (сигналы A/B/C/D)             │
│     └─ Записать в журнал                                │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│  4. ОБРАБОТКА                                           │
│     Для каждой записи:                                  │
│     ├─ Извлечь данные                                   │
│     ├─ Верифицировать связь (A/B/C)                     │
│     └─ Распределить: Итог или Кандидаты                 │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│  5. ЭКСПОРТ                                             │
│     └─ Создать results.xlsx (4 листа)                   │
└─────────────────────────────────────────────────────────┘
```

## Структура результата

### Лист 1: «Итог» — подтверждённые записи

| ФИО | Год рождения | Статус | Ссылка Память народа | Основание | Источник географии |
|-----|--------------|--------|---------------------|-----------|-------------------|
| Иванов Иван Иванович | 1920 | Погиб | https://pamyat-naroda.ru/... | A | Место рождения |

### Лист 2: «Кандидаты» — неопределённые совпадения

| ФИО | Год рождения | Причина сомнения | Ссылка | География |
|-----|--------------|------------------|--------|-----------|
| Петров Пётр Петрович | 1918 | Только район, без деревни | https://... | Кизнерский р-н |

### Лист 3: «Журнал» — лог поиска

| Вариант запроса | Попытка | Сигнал | Количество |
|-----------------|---------|--------|------------|
| Вишур | 1 | A | 47 |
| Вишур Кизнерский | 1 | A | 32 |

### Лист 4: «Варианты» — использованные написания

| Вариант написания |
|-------------------|
| Вишур |
| д. Вишур |
| Вишур Кизнерский район |

## Уровни верификации

### Уровень A — Полное подтверждение

Точное название населённого пункта найдено в одном из полей:
- Место рождения
- Место жительства
- Место призыва
- Место захоронения

**Пример:** `Место рождения: д. Вишур, Кизнерский р-н, Удмуртская АССР`

### Уровень B — Административное подтверждение

Совпадение административных привязок + короткий вариант названия.

**Пример:** `Призван: Кизнерский РВК` + фамилия характерна для Вишура

### Уровень C — Внешнее подтверждение

Ссылка на «Память народа» содержит географическое подтверждение.

### Неподтверждённые → Кандидаты

Записи без подтверждения A/B/C требуют ручной проверки.

## Протокол ожидания

Страница считается загруженной при появлении сигнала:

| Сигнал | Описание |
|--------|----------|
| **A** | Видимый список результатов |
| **B** | Отображено количество результатов |
| **C** | Видна пагинация |
| **D** | Явное сообщение «нет результатов» |

**Таймауты:** 8-12 секунд на попытку, до 3 попыток.

## Пример вывода

```
================================================================================
ПОИСК УЧАСТНИКОВ ВОВ: д. Вишур, Кизнерский район
================================================================================

Параметры:
- Населённый пункт: Вишур
- Район: Кизнерский район, Удмуртия
- Критерии: рождение/жительство/призыв
- Популяция: все участники

Варианты запросов:
1. Вишур
2. Вишур Кизнерский
3. д. Вишур Кизнерский район
4. Вишур Удмуртская АССР

================================================================================
РЕЗУЛЬТАТЫ ПОИСКА
================================================================================

✓ Вариант «Вишур»: 47 записей (сигнал A)
✓ Вариант «Вишур Кизнерский»: 32 записи (сигнал A)
✓ Вариант «д. Вишур Кизнерский район»: 28 записей (сигнал A)
✓ Вариант «Вишур Удмуртская АССР»: 15 записей (сигнал A)

Обработка карточек: 47/47 [████████████████████] 100%

================================================================================
ИТОГИ
================================================================================

📊 Статистика:
- Подтверждённых записей (Итог): 42
- Требуют проверки (Кандидаты): 5
- Всего уникальных: 47

📁 Создан файл: results.xlsx
   ├─ Итог: 42 записи
   ├─ Кандидаты: 5 записей
   ├─ Журнал: 4 запроса
   └─ Варианты: 4 написания

💡 Рекомендации:
- Проверьте «Кандидатов» вручную на pamyat-naroda.ru
- Сверьте фамилии с метрическими книгами деревни
```

## Нормализация статусов

| Исходный текст | Нормализованный |
|----------------|-----------------|
| погиб, убит, пал смертью храбрых | Погиб |
| пропал без вести, пропал б/в | Пропал без вести |
| умер от ран, умер от болезни | Умер от ран |
| умер в плену, погиб в плену | Умер в плену |
| вернулся, жив, демобилизован | Вернулся |

## Варианты написания

При поиске важно учитывать:

- **Официальные варианты:** Вишур, д. Вишур, дер. Вишур
- **С районом:** Вишур Кизнерский район, Вишур Кизнерского р-на
- **Исторические:** названия до переименований
- **Ошибки:** опечатки в документах военного времени
- **Транслитерация:** Vishur (в иностранных источниках)

## Связанные ресурсы

- [warsearch.ru](https://warsearch.ru) — агрегатор данных
- [pamyat-naroda.ru](https://pamyat-naroda.ru) — основной источник
- [obd-memorial.ru](https://obd-memorial.ru) — обобщённый банк данных

## Ограничения

- Требуется браузерное расширение Claude in Chrome для полной функциональности
- Скорость ограничена для избежания блокировки
- Качество данных зависит от источника
- Некоторые карточки могут быть недоступны

## Файлы

```
wsearch/
├── SKILL.md           # Инструкции для Claude Code
├── create_excel.py    # Скрипт создания Excel
├── README.md          # Документация
└── .claude/
    └── settings.json  # Разрешения
```

## Лицензия

MIT

## Автор

Создано для генеалогических исследований.
